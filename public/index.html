<!DOCTYPE html>
<html>
  <body style="background-color: bisque">
    <form id="form">
      <input
        type="text"
        name="url"
        value="https://twitter.com/ChainHackerClan/status/1616486060430589956"
      />
      <button type="submit">SUBMIT</button>
    </form>
    <div
      style="
        display: flex;
        align-items: flex-start;
        justify-content: flex-start;
        width: 100%;
        gap: 5px;
      "
    >
      <div style="flex: 0 0 45%">
        <img src="" id="image1" />
      </div>
      <div style="flex: 0 0 45%">
        <img src="" id="image2" />
      </div>
    </div>
  </body>
  <script>
    document.getElementById("form").addEventListener("submit", (event) => {
      event.preventDefault();
      console.log(event.target.url.value);
      const image1 = document.getElementById("image1");
      const image2 = document.getElementById("image2");
      image1.src = "images/wait.png";
      image2.src = "images/wait.png";
      fetch("/send", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ url: event.target.url.value }),
      }).then((response) => {
        console.log(response.status);
        response.blob().then((blob) => {
          const objectURL = URL.createObjectURL(blob);
          image1.style = "width: 90%; display: block;";
          image1.src = objectURL;
        });
        fetch(`/stamped?file=${event.target.url.value}`).then((response) => {
          response.blob().then((blob) => {
            const objectURL = URL.createObjectURL(blob);
            const image2 = document.getElementById("image2");
            image2.style = "width: 90%;  display: block;";
            image2.src = objectURL;
          });
        });
      });
    });
  </script>
</html>
